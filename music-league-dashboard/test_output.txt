npm warn Unknown cli config "--t". This will stop working in the next major version of npm.
npm warn Unknown cli config "--run". This will stop working in the next major version of npm.

> music-league-dashboard@0.0.0 test
> vitest tests/backend/api.test.js GET /api/stats/overview


[1m[44m DEV [49m[22m [34mv3.2.4 [39m[90mF:/software/m/mleager/music-league-dashboard[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã´Ã­ add observability to secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/backend/api.test.js[2m > [22m[2mBackend API[2m > [22m[2mGET /api/leagues[2m > [22m[2mshould return all leagues
[22m[39mFetched leagues: [ { _id: [32m'1'[39m, name: [32m'League 1'[39m } ]

[90mstdout[2m | tests/backend/api.test.js[2m > [22m[2mBackend API[2m > [22m[2mGET /api/stats/overview[2m > [22m[2mshould return overview stats
[22m[39mCounts: {
  totalSubmissions: [33m100[39m,
  totalVotes: [33m500[39m,
  totalRounds: [33m10[39m,
  totalCompetitors: [33m20[39m
}

stderr | tests/backend/api.test.js > Backend API > GET /api/stats/overview > should return overview stats
Error fetching overview stats: TypeError: league.toObject is not a function
    at getOverviewStats (F:\software\m\mleager\music-league-dashboard\src\controllers\statsController.js:35:27)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)

stderr | tests/backend/api.test.js > Backend API > GET /api/stats/overview > should return overview stats
{ error: 'Failed to fetch overview stats' }

 [31mÃ”Ã˜Â»[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 36[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues[2m > [22mshould return all leagues[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Backend API[2m > [22mGET /api/stats/overview[2m > [22mshould return overview stats[39m[32m 13[2mms[22m[39m
[31m     Ã”Ã¥Ã† expected 500 to be 200 // Object.is equality[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/songs[2m > [22mshould return aggregated songs[32m 4[2mms[22m[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 1 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  tests/backend/api.test.js > Backend API > GET /api/stats/overview > should return overview stats
AssertionError: expected 500 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 500

 Ã”Ã˜Â» tests/backend/api.test.js:90:30
     88|             if (res.status !== 200) console.error(res.body);
     89|             expect(res.status).toBe(200);
     90|             expect(res.body).toHaveProperty('totalSubmissions', 100);
       |                              ^
     91|             expect(res.body).toHaveProperty('totalVotes', 500);
     92|             expect(res.body).toHaveProperty('totalRounds', 10);

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/1]Ã”Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 14:34:32
[2m   Duration [22m 2.22s[2m (transform 62ms, setup 0ms, collect 722ms, tests 36ms, environment 841ms, prepare 420ms)[22m

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx1 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¹Ã©Â´Â©Ã… backup and recover secrets: https://dotenvx.com/ops

 [2m[90mÃ”Ã¥Ã´[39m[22m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m

[2m Test Files [22m [33m1 skipped[39m[90m (1)[39m
[2m      Tests [22m [90m (3)[39m
[2m   Start at [22m 14:35:08
[2m   Duration [22m 851ms

[1m[41m CANCELLED [49m[22m [31mTest run cancelled. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx2 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¹Ã©Â´Â©Ã… backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/backend/api.test.js[2m > [22m[2mBackend API[2m > [22m[2mGET /api/leagues[2m > [22m[2mshould return all leagues
[22m[39mFetched leagues: [ { _id: [32m'1'[39m, name: [32m'League 1'[39m } ]

[90mstdout[2m | tests/backend/api.test.js[2m > [22m[2mBackend API[2m > [22m[2mGET /api/stats/overview[2m > [22m[2mshould return overview stats
[22m[39mCounts: {
  totalSubmissions: [33m100[39m,
  totalVotes: [33m500[39m,
  totalRounds: [33m10[39m,
  totalCompetitors: [33m20[39m
}

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 48[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 14:42:18
[2m   Duration [22m 974ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/leagueController.js [22m[34mx3 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  write to custom object with { processEnv: myObject }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 32[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:18:13
[2m   Duration [22m 1.02s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/statsController.js [22m[34mx4 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  override existing env vars with { override: true }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 39[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:18:16
[2m   Duration [22m 935ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx5 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  write to custom object with { processEnv: myObject }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 37[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:18:18
[2m   Duration [22m 923ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx6 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  specify custom .env file path with { path: '/custom/path/.env' }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 34[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:18:21
[2m   Duration [22m 817ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx7 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”Â£Ã  audit secrets and track compliance: https://dotenvx.com/ops

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 34[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:18:23
[2m   Duration [22m 983ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/songController.js [22m[34mx8 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¶Ã¤ add secrets lifecycle management: https://dotenvx.com/ops

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 35[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:30:56
[2m   Duration [22m 901ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx9 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¶Ã‰ prevent committing .env to code: https://dotenvx.com/precommit

 [31mÃ”Ã˜Â»[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 46[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues[2m > [22mshould return all leagues[32m 23[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/stats/overview[2m > [22mshould return overview stats[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Backend API[2m > [22mGET /api/songs[2m > [22mshould return aggregated songs[39m[32m 13[2mms[22m[39m
[31m     Ã”Ã¥Ã† expected { title: 'Song 1', Ã”Ã‡Âª(4) } to have property "created"[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 1 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  tests/backend/api.test.js > Backend API > GET /api/songs > should return aggregated songs
AssertionError: expected { title: 'Song 1', Ã”Ã‡Âª(4) } to have property "created"
 Ã”Ã˜Â» tests/backend/api.test.js:106:12
    104|             expect(res.body[0]).toHaveProperty('avgVotes', '5.0');
    105|             expect(res.body[0]).toHaveProperty('created');
    106|         });
       |            ^
    107|     });
    108| });

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/1]Ã”Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:31:55
[2m   Duration [22m 894ms

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx10 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  load multiple .env files with { path: ['.env.local', '.env'] }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 34[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:32:20
[2m   Duration [22m 1.11s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/songController.js [22m[34mx11 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¸Ã¡Â´Â©Ã…  run anywhere with `dotenvx run -- yourcommand`

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 37[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:42:55
[2m   Duration [22m 1.37s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/statsController.js [22m[34mx12 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  specify custom .env file path with { path: '/custom/path/.env' }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 49[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:42:58
[2m   Duration [22m 1.41s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/controllers/songController.js [22m[34mx13 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¶Ã¦ add access controls to secrets: https://dotenvx.com/ops

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 85[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:49:54
[2m   Duration [22m 1.30s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx14 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  suppress all logs with { quiet: true }

 [31mÃ”Ã˜Â»[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 41[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues[2m > [22mshould return all leagues[32m 22[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/stats/overview[2m > [22mshould return overview stats[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Backend API[2m > [22mGET /api/songs[2m > [22mshould return aggregated songs[39m[32m 11[2mms[22m[39m
[31m     Ã”Ã¥Ã† expected { title: 'Song 1', Ã”Ã‡Âª(6) } to have property "genres"[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 1 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  tests/backend/api.test.js > Backend API > GET /api/songs > should return aggregated songs
AssertionError: expected { title: 'Song 1', Ã”Ã‡Âª(6) } to have property "genres"
 Ã”Ã˜Â» tests/backend/api.test.js:107:33
    105|             expect(res.body[0]).toHaveProperty('created');
    106|             expect(res.body[0]).toHaveProperty('genres');
    107|             expect(Array.isArray(res.body[0].genres)).toBe(true);
       |                                 ^
    108|             expect(res.body[0]).toHaveProperty('album');
    109|         });

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/1]Ã”Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:50:04
[2m   Duration [22m 1.19s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx15 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m3 tests[22m[2m)[22m[32m 93[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 16:50:29
[2m   Duration [22m 1.52s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx16 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  suppress all logs with { quiet: true }

 [31mÃ”Ã˜Â»[39m tests/backend/api.test.js [2m([22m[2m7 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 51[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues[2m > [22mshould return all leagues[32m 21[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/stats/overview[2m > [22mshould return overview stats[32m 7[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/songs[2m > [22mshould return aggregated songs[32m 6[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues/:leagueId[2m > [22mshould return league details[32m 5[2mms[22m[39m
   [32mÃ”Â£Ã´[39m Backend API[2m > [22mGET /api/leagues/:leagueId[2m > [22mshould return 404 if league not found[32m 5[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Backend API[2m > [22mGET /api/rounds/:roundId[2m > [22mshould return round details[39m[32m 4[2mms[22m[39m
[31m     Ã”Ã¥Ã† Cannot read properties of undefined (reading 'mockResolvedValue')[39m
[31m   [31mâ”œÃ¹[31m Backend API[2m > [22mGET /api/rounds/:roundId[2m > [22mshould return 404 if round not found[39m[32m 1[2mms[22m[39m
[31m     Ã”Ã¥Ã† Cannot read properties of undefined (reading 'mockResolvedValue')[39m

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â» Failed Tests 2 Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»

 FAIL  tests/backend/api.test.js > Backend API > GET /api/rounds/:roundId > should return round details
TypeError: Cannot read properties of undefined (reading 'mockResolvedValue')
 Ã”Ã˜Â» tests/backend/api.test.js:140:30
    138|             const round = { _id: 'r1', name: 'Round 1' };
    139|             mocks.round.findOne.mockResolvedValue(round);
    140|             mocks.submission.find.mockResolvedValue([{ spotifyUri: 'urÃ”Ã‡Âª
       |                              ^
    141|             mocks.vote.find.mockResolvedValue([]);
    142|             mocks.songMetadata.findOne.mockResolvedValue({ title: 'SonÃ”Ã‡Âª

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[1/2]Ã”Ã„Â»

 FAIL  tests/backend/api.test.js > Backend API > GET /api/rounds/:roundId > should return 404 if round not found
TypeError: Cannot read properties of undefined (reading 'mockResolvedValue')
 Ã”Ã˜Â» tests/backend/api.test.js:154:31
    152|         it('should return 404 if round not found', async () => {
    153|             mocks.round.findOne.mockResolvedValue(null);
    154|             const res = await request(app).get('/api/rounds/unknown');
       |                               ^
    155|             expect(res.status).toBe(404);
    156|         });

Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»Ã”Ã„Â»[2/2]Ã”Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m5 passed[39m[22m[90m (7)[39m
[2m   Start at [22m 16:55:48
[2m   Duration [22m 985ms

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/backend/api.test.js [22m[34mx17 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  override existing env vars with { override: true }

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 50[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m7 passed[39m[22m[90m (7)[39m
[2m   Start at [22m 16:56:58
[2m   Duration [22m 490ms

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/models/SongMetadata.js [22m[34mx18 [34m[39m
       [2m Filename pattern: [22m[34mtests/backend/api.test.js, GET /api/stats/overview[39m

[90mstdout[2m | tests/backend/api.test.js
[22m[39m[dotenv@17.2.3] injecting env (10) from .env -- tip: Â­Æ’Ã¶Ã¦ add access controls to secrets: https://dotenvx.com/ops

 [32mÃ”Â£Ã´[39m tests/backend/api.test.js [2m([22m[2m7 tests[22m[2m)[22m[32m 86[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m7 passed[39m[22m[90m (7)[39m
[2m   Start at [22m 17:22:46
[2m   Duration [22m 1.02s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
